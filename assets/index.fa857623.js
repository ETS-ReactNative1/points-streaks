var be=Object.defineProperty,ve=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var K=(e,t,s)=>t in e?be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))W.call(t,s)&&K(e,s,t[s]);if(x)for(var s of x(t))G.call(t,s)&&K(e,s,t[s]);return e},f=(e,t)=>ve(e,Ie(t));var b=(e,t)=>{var s={};for(var a in e)W.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&x)for(var a of x(e))t.indexOf(a)<0&&G.call(e,a)&&(s[a]=e[a]);return s};import{c as j,a as z,b as X,n as Y,d as k,_ as Te,e as O,h as De,p as Ae,g as Re,D as $e,i as xe,L as ze,j as i,R as Ee,f as Q,k as S,l as d,m as y,o as _e,q as Pe,r as Ne,s as we,F as He,t as Ce,P as je,u as Oe,v as Fe,w as Be,x as Le,y as Ve,z as Z,N as ee,A as Me,B as te,C as qe,E as Ue,G as Je,H as We}from"./vendor.960f46a5.js";const Ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}};Ge();const v=j("reset");j("set");const I=j("resolveDay"),E={pizza:"pizza"},se={points:0,special:{[E.pizza]:0}},ae={pizza:e=>{var t;return((t=e==null?void 0:e.points)!=null?t:e)*.05}},Ke={extraReducers:{[v]:()=>se,[I]:(e,{payload:{bank:t}})=>{Object.entries(t).forEach(([s,a])=>{var r;s==="points"?e.points+=a:e.special[s]=((r=e.special[s])!=null?r:0)+a})}},initialState:se,name:"bank",reducers:{addPoints(e,{payload:t}){e.points+=t},addSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]+=t},setPoints(e,{payload:t}){e.points=t},setSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]=t},spendPoints(e,{payload:t}){t<=e.points&&(e.points-=t)},spendSpecial(e,{payload:{amount:t,type:s="pizza"}}){t<=e.special[s]&&(e.special[s]-=t)}}},Xe=e=>{var t;return(t=e==null?void 0:e.bank)!=null?t:e},Ye=(e,t)=>{var s;return((s=e==null?void 0:e.bank)!=null?s:e).special[t]},Qe=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).special.pizza},Ze=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).points},et=(e,t)=>ae[t](e),re={getBank:Xe,getPizza:Qe,getPoints:Ze,getSpecial:Ye,getSpecialValue:et},ne=z(Ke);var tt=ne.reducer;const ie=ne.actions,st=e=>{const t=e.reduce((s,a)=>(s[a.id.replace(/ /g,"-")]=a,s),{});return{entities:t,ids:Object.keys(t)}},oe=e=>t=>(s,{payload:a})=>e.updateOne(s,{changes:t,id:a}),ce=e=>t=>(s,a,...r)=>{var o,n;return e.updateOne(s,{changes:t(s.entities[(n=(o=a.payload)==null?void 0:o.id)!=null?n:a.payload],a,r),id:a.payload})},p={active:"active",done:"done"};function F(e,t={}){return c({currentStreakIndex:1,id:Y(),status:p.active,streakIterations:1,task:e},t)}const le=6,T=X(),_="a",P="b";_+"",F(_,{id:_}),P+"",F(P,{id:P});const de=st(["email","meditate","teeth","clean 5%","quirk","walk","dev tea","luminosity","\u{1F50A}\u{1F4DA} (20)","read(20)","track \u{1F96A}","track \u{1F964}","fiber \u{1F9FB}","#points","reduce lists 5%"].map(e=>F(e,{id:e.replace(/ /g,"-")}))),B=oe(T),D=ce(T);function ue(e){return e.currentStreakIndex===le?{currentStreakIndex:1,streakIterations:e.streakIterations+1}:{currentStreakIndex:e.currentStreakIndex+1}}const pe=z({extraReducers:{[v]:(e,{payload:t})=>{var s;return T.getInitialState((s=t==null?void 0:t.streaks)!=null?s:de)},[I]:(e,{payload:t})=>{t.tasks&&Object.values(e.entities).forEach(s=>{s.status===p.active?(s.streakIterations=1,s.currentStreakIndex=1):(s.status=p.active,D(ue)(e,{payload:s.id}))})}},initialState:T.getInitialState(de),name:"streaks",reducers:{bumpStreak:D(ue),bumpStreakIndex:D(e=>({currentStreakIndex:e.currentStreakIndex+1})),bumpStreakIterations:D(e=>({streakIterations:e.streakIterations+1})),markTaskActive:B({status:p.active}),markTaskDone:B({status:p.done}),resetStreak:B({currentStreakIndex:1,status:p.active,streakIterations:1}),toggleTaskStatus:D(e=>({status:e.status===p.active?p.done:p.active}))}}),at=pe.reducer,ke=pe.actions,u=T.getSelectors(e=>{var t;return(t=e==null?void 0:e.streaks)!=null?t:e});u.getStreak=u.selectById;u.getStreakIndex=k(u.getStreak,e=>e.currentStreakIndex);u.getStreakIteration=k(u.getStreak,e=>e.streakIterations);u.getStreakValue=k(u.getStreak,e=>e.status===p.active?0:e.currentStreakIndex===le?E.pizza:e.currentStreakIndex*e.streakIterations);u.getDaysPoints=k([u.selectIds,e=>e],(e,t)=>e.map(s=>u.getStreakValue(t,s)).reduce((s,a)=>{var r;return Number.isInteger(a)?s.points+=a:s[E[a]]=((r=s==null?void 0:s[E[a]])!=null?r:0)+1,s},{points:0}));const rt={active:"active",done:"done"};function N(e,t={}){return typeof e=="object"&&(t=e),c({history:[],id:Y(),status:rt.active,task:e,value:1},t)}const w="a",H="b";w+"",N(w,{id:w}),H+"",N(H,{id:H});const m={active:"active",done:"done"},g=X(),me=oe(g),ge=ce(g);function nt(e,t){var a,r;const s=(r=(a=t==null?void 0:t.payload)==null?void 0:a.id)!=null?r:t.payload;return typeof s=="string"&&s in e.entities?s:null}const it=ge((e,t)=>{e.history||(e.history=[]),e.history.push({action:t,date:Date.now()})}),ot=e=>(t,s)=>{const a=e(t,s);return nt(a,s)?it(a,s):a};function he(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>{const a=ot(s);return[t,a]}))}const L=z({extraReducers:he({[v]:()=>g.getInitialState({history:{}}),[I]:(e,t)=>{const{payload:s}=t;s.tasks&&Object.values(e.entities).forEach(a=>{a.status===m.done&&(e.history[a.id]=!0,a.value=0,a.history.push({action:t,date:Date.now()}))})}}),initialState:g.getInitialState({history:{}}),name:"tasks",reducers:he({createTask:(e,{payload:t})=>g.addOne(e,N(t)),createTasks:(e,{payload:t})=>g.addMany(e,t.map(s=>N(s))),markTaskActive:me({status:m.active}),markTaskDone:me({status:m.done}),restoreTask:(e,{payload:t})=>(e.history[t]=!1,g.updateOne(e,{changes:{status:m.active},id:t}),e),toggleTaskStatus:ge(e=>({status:e.status===m.active?m.done:m.active}))})});L.getInitialState();const ct=L.reducer,A=L.actions,l=g.getSelectors(e=>{var t;return(t=e==null?void 0:e.tasks)!=null?t:e});l.getTask=l.selectById;l.getValue=k(l.getTask,e=>e.value);l.getDaysPoints=k([l.selectIds,e=>e],(e,t)=>e.reduce((s,a)=>s+l.getValue(t,a),0));l.getHistory=k(e=>e.tasks,e=>e.history);l.getHistoricalTasks=k(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>t[s.id]));l.getActiveTasks=k(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>!t[s.id]));function lt(e){try{JSON.parse(e)}catch{return!1}return isNaN(e)}const dt=(e="param")=>()=>{throw new Error(`${Array.isArray(e)?e[0]:e} is required`)},ut=dt,pt=e=>lt(e)?JSON.parse(e):e,kt=e=>c(c({},{debug:!0,deserialize:pt,key:"root",stateReconciler:Te,storage:O}),e);function mt(e,t=2e3){const s=Ae({interval:t,limit:1})(a=>Re(e,a).catch(console.error));return{deleteItem:s,getItem:()=>De(e).then(a=>a.data()).catch(console.error),setItem:s}}function gt(e){xe(e);const t=ze();return $e(t,"state","state")}const ht=(e,t)=>{const s=gt(e);return mt(s,t)},ft=e=>Object.entries(JSON.parse(e)).reduce((t,[s,a])=>f(c({},t),{[s]:JSON.parse(a)}),{}),yt=(e=ut`firebaseConfig`,t=100)=>{const s=ht(e,t),a={deleteItem:(...r)=>O.deleteItem(...r).then(o=>(s.deleteItem(),o)),getItem:s.getItem,setItem:(r,o)=>O.setItem(r,o).then(()=>s.setItem(ft(o)))};return kt({storage:a})},St={apiKey:"AIzaSyD7U2xm2iJuhM6XOs4dGMtAmqlT6TWh1I0",appId:"1:72274275033:web:a9f21b39f1856ea326acc8",authDomain:"points-streaks.firebaseapp.com",messagingSenderId:"72274275033",projectId:"points-streaks",storageBucket:"points-streaks.appspot.com"},bt=(e,t)=>Math.abs(e-t),vt=({streakIterations:e,currentStreakIndex:t})=>{const s=Array(5).fill(0).map((a,r)=>r+e).concat("\u{1F355}");return i("div",{className:"streak",children:s.map((a,r)=>i("span",{className:`point dist-${bt(t,r+1)}`,children:a},a))})},fe=({task:e,children:t,isDone:s})=>i(Ee,{className:Q("name",{done:s}),children:t!=null?t:e}),It=({value:e,children:t})=>i("code",{className:"value",children:t!=null?t:e}),V=a=>{var r=a,{children:e,toggleTaskStatus:t}=r,s=b(r,["children","toggleTaskStatus"]);let o=S.Children.toArray(e);return o.length?o.length===1&&o.unshift(fe):o=[fe,It],d("div",{className:"task",onClick:t,children:[i("input",{type:"checkbox",readOnly:!0,checked:s.isDone}),o.map((n,$)=>{var U,J;const h=`${s.id}_${(J=(U=n==null?void 0:n.type)==null?void 0:U.name)!=null?J:n.type}_${$}`;return S.isValidElement(n)?S.cloneElement(n,f(c({},s),{key:h})):S.createElement(n,f(c({},s),{key:h}))})]})};function Tt(e){return function(s){console.log(s),s.preventDefault(),e.forEach(({name:a,onSubmit:r})=>{r(s.target.elements[a].value,s)})}}const Dt=({children:e})=>{const t=S.Children.toArray(e).map(s=>{var o;const{onSubmit:a,name:r}=(o=s==null?void 0:s.props)!=null?o:{};return{name:r,onSubmit:a}});return d("form",{onSubmit:Tt(t),children:[e,i("input",{type:"submit",style:{display:"none"}})]})},At=e=>i(V,f(c({},e),{children:i(vt,{})})),Rt=y((e,{status:t})=>({isDone:t===p.done}),(e,{id:t})=>({toggleTaskStatus:()=>e(ke.toggleTaskStatus(t))}))(At);function R(e=new Date){return new Date(e).setHours(0,0,0,0)}function $t(e){return e.app.date===R()?{app:{},bank:{},streaks:!1,tasks:!1}:{app:{date:R()},bank:u.getDaysPoints(e),streaks:!0,tasks:!0}}const ye=z({extraReducers:{[v]:()=>({date:R()}),[I]:(e,{payload:t})=>{var s,a;e.date=(a=(s=t==null?void 0:t.app)==null?void 0:s.date)!=null?a:e.date}},initialState:{date:R()},name:"app",reducers:{setDate:(e,{payload:t})=>{e.date=R(t)}}});var xt=ye.reducer;const zt=ye.actions,Et={},_t=yt(St),Pt=c({key:"root",version:1},_t);c(c(c(c({reset:v},A),zt),ie),ke);const C={app:Et,bank:re,streaks:u,tasks:l},Nt=_e({app:xt,bank:tt,streaks:at,tasks:ct}),wt=Pe(Pt,Nt),M=Ne({devTools:!0,middleware:e=>e({serializableCheck:{ignoredActions:[He,Ce,je,Oe,Fe,Be]}}),reducer:wt});let Ht=we(M);M.getState();const Ct=e=>t=>{t.preventDefault(),e(t.target.elements.tasks.value.split(`
`))},jt=({createTask:e,createTasks:t})=>d("form",{onSubmit:Ct(t),children:[i("textarea",{name:"tasks"}),i("button",{type:"submit",children:"Submit"})]}),Ot=y(null,e=>({createTask:t=>e(A.createTask(t)),createTasks:t=>e(A.createTasks(t))}))(jt),Ft=e=>i(V,c({},e)),Bt=y((e,{status:t})=>({isDone:t===m.done}),(e,{id:t})=>({toggleTaskStatus:()=>e(A.toggleTaskStatus(t))}))(Ft),Lt=s=>{var a=s,{restoreTask:e}=a,t=b(a,["restoreTask"]);return i(V,f(c({},t),{children:i("button",{onClick:e,children:"Restore"})}))},Vt=y((e,{status:t})=>({isDone:t===m.done}),(e,{id:t})=>({toggleTaskStatus:()=>{},restoreTask:()=>e(A.restoreTask(t))}))(Lt),Mt=({addPoints:e})=>i(Dt,{children:i("input",{id:"bankInput",type:"number",name:"num",onSubmit:t=>e(Number(t))})}),qt=y(null,e=>({addPoints:t=>e(ie.addPoints(console.tap(t,typeof t)))}))(Mt),Ut=({special:e,points:t})=>d("main",{id:"bank",children:[i("h3",{children:"points:"}),i("h3",{children:t}),i(qt,{}),Object.entries(e).map(([s,a])=>d(Le,{children:[d("h3",{children:[s,":"]}),d("h3",{children:[a,"( worth: ",Math.round(ae[s](t)*a),")"]})]}))]}),Jt=y(re.getBank)(Ut);function Wt(){return new URL(document.location).searchParams.get("debug")==="ui"}function Gt({streaks:e,tasks:t,lastRunDate:s,resolveDay:a,historicalTasks:r,activeTasks:o}){return Ve.exports.useEffect(()=>(Z.exports.startReportingRuntimeErrors({onError:()=>{}}),()=>Z.exports.stopReportingRuntimeErrors()),[]),d("div",{className:Q("App",{debug:Wt()}),children:[i(Ot,{}),d("button",{onClick:()=>a(),children:["Resolve ",s]}),i(Jt,{}),d("div",{id:"task-section",children:[i("div",{className:"task-list",children:e.map(n=>i(Rt,c({},n),n.id))}),d("span",{children:[i(ee,{to:"active",className:({isActive:n})=>`task-list-link ${n?"active":""}`,children:"Active"}),i(ee,{to:"history",className:({isActive:n})=>`task-list-link ${n?"active":""}`,children:"History"})]}),d(Me,{children:[i(te,{path:"/active",element:d("div",{className:"task-list",children:[i("h3",{children:"Active"}),o.map(n=>i(Bt,c({},n),n.id))]})}),i(te,{path:"/history",element:d("div",{className:"task-list",children:[i("h3",{children:"History"}),r.map(n=>i(Vt,c({},n),n.id))]})})]})]})]})}function Kt(e){var t={day:"numeric",month:"long",weekday:"long"};return new Intl.DateTimeFormat("en-US",t).format(new Date(e))}var Xt=y(e=>({activeTasks:C.tasks.getActiveTasks(e),historicalTasks:C.tasks.getHistoricalTasks(e),lastRunDate:Kt(e.app.date),state:e,streaks:C.streaks.selectAll(e),tasks:C.tasks.selectAll(e)}),e=>({resolveDay:t=>()=>e(I($t(t)))}),(o,$,r)=>{var n=o,{state:e}=n,t=b(n,["state"]);var h=$,{resolveDay:s}=h,a=b(h,["resolveDay"]);return f(c(c(c({},r),a),t),{resolveDay:s(e)})})(Gt);const Yt="modulepreload",Se={},Qt="/points-streaks/",Zt=function(t,s){return!s||s.length===0?t():Promise.all(s.map(a=>{if(a=`${Qt}${a}`,a in Se)return;Se[a]=!0;const r=a.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${o}`))return;const n=document.createElement("link");if(n.rel=r?"stylesheet":Yt,r||(n.as="script",n.crossOrigin=""),n.href=a,document.head.appendChild(n),r)return new Promise(($,h)=>{n.addEventListener("load",$),n.addEventListener("error",h)})})).then(()=>t())};let q=[];const es=e=>{q.push(e),q.length>=5&&console.table(q)},ts=e=>{e&&e instanceof Function&&Zt(()=>import("./web-vitals.8eea515e.js"),[]).then(({getCLS:t,getFID:s,getFCP:a,getLCP:r,getTTFB:o})=>{t(e),s(e),a(e),r(e),o(e)})},ss=({children:e})=>i(Je,{store:M,children:i(We,{loading:null,persistor:Ht,children:e})});console.tap=(e,...t)=>(console.log(e,...t),e);qe.render(i(S.StrictMode,{children:i(Ue,{children:i(ss,{children:i(Xt,{})})})}),document.getElementById("root"));ts(es);
