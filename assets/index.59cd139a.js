var ge=Object.defineProperty,fe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var G=(e,t,s)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))U.call(t,s)&&G(e,s,t[s]);if(D)for(var s of D(t))J.call(t,s)&&G(e,s,t[s]);return e},m=(e,t)=>fe(e,me(t));var A=(e,t)=>{var s={};for(var a in e)U.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&D)for(var a of D(e))t.indexOf(a)<0&&J.call(e,a)&&(s[a]=e[a]);return s};import{c as F,a as x,b as K,n as W,d as p,j as n,e as X,R as h,f as k,g as R,_ as Se,h as O,i as he,p as ye,k as ve,D as Ie,l as be,L as Te,m as De,o as Ae,q as xe,r as Re,F as ze,s as $e,P as Ne,t as Ee,u as Pe,v as Ce,w as we,x as Y,N as Q,y as _e,z as Z,A as Fe,B as Oe,C as je,E as Be}from"./vendor.df836972.js";const He=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}};He();const y=F("reset");F("set");const v=F("resolveDay"),z={pizza:"pizza"},ee={points:0,special:{[z.pizza]:0}},Le={pizza:e=>e.points*.05},Me={name:"bank",initialState:ee,reducers:{spendPoints(e,{payload:t}){t<=e.points&&(e.points-=t)},addPoints(e,{payload:t}){e.points+=t},setPoints(e,{payload:t}){e.points=t},spendSpecial(e,{payload:{amount:t,type:s="pizza"}}){t<=e.special[s]&&(e.special[s]-=t)},addSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]+=t},setSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]=t}},extraReducers:{[y]:()=>ee,[v]:(e,{payload:{bank:t}})=>{Object.entries(t).forEach(([s,a])=>{var r;s==="points"?e.points+=a:e.special[s]=((r=e.special[s])!=null?r:0)+a})}}},Ve=(e,t)=>{var s;return((s=e==null?void 0:e.bank)!=null?s:e).special[t]},qe=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).special.pizza},Ue=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).points},Je=(e,t)=>Le[t](e),Ge={getPizza:qe,getSpecialValue:Je,getPoints:Ue,getSpecial:Ve},te=x(Me);var Ke=te.reducer;const We=te.actions,Xe=e=>{const t=e.reduce((s,a)=>(s[a.id.replace(/ /g,"-")]=a,s),{});return{ids:Object.keys(t),entities:t}},se=e=>t=>(s,{payload:a})=>e.updateOne(s,{id:a,changes:t}),ae=e=>t=>(s,{payload:a})=>e.updateOne(s,{id:a,changes:t(s.entities[a])}),u={active:"active",done:"done"};function j(e,t={}){return c({id:W(),status:u.active,task:e,streakIterations:1,currentStreakIndex:1},t)}const re=6,I=K(),$="a",N="b";$+"",j($,{id:$}),N+"",j(N,{id:N});const ne=Xe(["email","meditate","teeth","clean 5%","quirk","walk","dev tea","luminosity","\u{1F50A}\u{1F4DA} (20)","read(20)","track \u{1F96A}","track \u{1F964}","fiber \u{1F9FB}","#points"].map(e=>j(e,{id:e.replace(/ /g,"-")}))),B=se(I),b=ae(I);function ie(e){return e.currentStreakIndex===re?{streakIterations:e.streakIterations+1,currentStreakIndex:1}:{currentStreakIndex:e.currentStreakIndex+1}}const oe=x({name:"streaks",initialState:I.getInitialState(ne),reducers:{toggleTaskStatus:b(e=>({status:e.status===u.active?u.done:u.active})),markTaskActive:B({status:u.active}),markTaskDone:B({status:u.done}),bumpStreakIterations:b(e=>({streakIterations:e.streakIterations+1})),bumpStreakIndex:b(e=>({currentStreakIndex:e.currentStreakIndex+1})),bumpStreak:b(ie),resetStreak:B({status:u.active,streakIterations:1,currentStreakIndex:1})},extraReducers:{[y]:(e,{payload:t})=>{var s;return I.getInitialState((s=t==null?void 0:t.streaks)!=null?s:ne)},[v]:(e,{payload:t})=>{t.tasks&&Object.values(e.entities).forEach(s=>{s.status===u.active?(s.streakIterations=1,s.currentStreakIndex=1):(s.status=u.active,b(ie)(e,{payload:s.id}))})}}}),Ye=oe.reducer,ce=oe.actions,d=I.getSelectors(e=>{var t;return(t=e==null?void 0:e.streaks)!=null?t:e});d.getStreak=d.selectById;d.getStreakIndex=p(d.getStreak,e=>e.currentStreakIndex);d.getStreakIteration=p(d.getStreak,e=>e.streakIterations);d.getStreakValue=p(d.getStreak,e=>e.status===u.active?0:e.currentStreakIndex===re?z.pizza:e.currentStreakIndex*e.streakIterations);d.getDaysPoints=p([d.selectIds,e=>e],(e,t)=>e.map(s=>d.getStreakValue(t,s)).reduce((s,a)=>{var r;return Number.isInteger(a)?s.points+=a:s[z[a]]=((r=s==null?void 0:s[z[a]])!=null?r:0)+1,s},{points:0}));const Qe={active:"active",done:"done"};function E(e,t={}){return typeof e=="object"&&(t=e),c({id:W(),status:Qe.active,task:e,value:1},t)}const P="a",C="b";P+"",E(P,{id:P}),C+"",E(C,{id:C});const g={active:"active",done:"done"},f=K(),le=se(f),Ze=ae(f),H=x({name:"tasks",initialState:f.getInitialState({history:{}}),reducers:{createTasks:(e,{payload:t})=>f.addMany(e,t.map(s=>E(s))),createTask:(e,{payload:t})=>f.addOne(e,E(t)),toggleTaskStatus:Ze(e=>({status:e.status===g.active?g.done:g.active})),markTaskActive:le({status:g.active}),markTaskDone:le({status:g.done}),restoreTask:(e,{payload:t})=>{e.history[t]=!1,f.updateOne(e,{id:t,changes:{status:g.active}})}},extraReducers:{[y]:()=>f.getInitialState({history:{}}),[v]:(e,{payload:t})=>{t.tasks&&Object.values(e.entities).forEach(s=>{s.status===g.done&&(e.history[s.id]=!0)})}}});H.getInitialState();const et=H.reducer,w=H.actions,l=f.getSelectors(e=>{var t;return(t=e==null?void 0:e.tasks)!=null?t:e});l.getTask=l.selectById;l.getValue=p(l.getTask,e=>e.value);l.getDaysPoints=p([l.selectIds,e=>e],(e,t)=>e.reduce((s,a)=>s+l.getValue(t,a),0));l.getHistory=p(e=>e.tasks,e=>e.history);l.getHistoricalTasks=p(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>t[s.id]));l.getActiveTasks=p(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>!t[s.id]));const tt=(e,t)=>Math.abs(e-t),st=({streakIterations:e,currentStreakIndex:t})=>{const s=Array(5).fill(0).map((a,r)=>r+e).concat("\u{1F355}");return n("div",{className:"streak",children:s.map((a,r)=>n("span",{className:`point dist-${tt(t,r+1)}`,children:a},a))})},de=({task:e,children:t,isDone:s})=>n("h3",{className:X("name",{done:s}),children:t!=null?t:e}),at=({value:e,children:t})=>n("code",{className:"value",children:t!=null?t:e}),ue=a=>{var r=a,{children:e,toggleTaskStatus:t}=r,s=A(r,["children","toggleTaskStatus"]);let i=h.Children.toArray(e);return i.length?i.length===1&&i.unshift(de):i=[de,at],k("div",{className:"task",onClick:t(s.id),children:[n("input",{type:"checkbox",readOnly:!0,checked:s.isDone}),i.map((o,M)=>{var V,q;const S=`${s.id}_${(q=(V=o==null?void 0:o.type)==null?void 0:V.name)!=null?q:o.type}_${M}`;return h.isValidElement(o)?h.cloneElement(o,m(c({},s),{key:S})):h.createElement(o,m(c({},s),{key:S}))})]})},rt=e=>n(ue,m(c({},e),{children:n(st,{})})),nt=R((e,{status:t})=>({isDone:t===u.done}),e=>({toggleTaskStatus:t=>()=>e(ce.toggleTaskStatus(t))}))(rt);function T(e=new Date){return new Date(e).setHours(0,0,0,0)}function it(e){return e.app.date===T()?{bank:{},streaks:!1,tasks:!1,app:{}}:{bank:d.getDaysPoints(e),tasks:!0,streaks:!0,app:{date:T()}}}const pe=x({name:"app",initialState:{date:T()},reducers:{setDate:(e,{payload:t})=>{e.date=T(t)}},extraReducers:{[y]:()=>({date:T()}),[v]:(e,{payload:t})=>{var s,a;e.date=(a=(s=t==null?void 0:t.app)==null?void 0:s.date)!=null?a:e.date}}});var ot=pe.reducer;const ct=pe.actions,lt={};function dt(e){try{JSON.parse(e)}catch{return!1}return isNaN(e)}const ut=(e="param")=>()=>{throw new Error(`${Array.isArray(e)?e[0]:e} is required`)},pt=ut,kt=e=>dt(e)?JSON.parse(e):e,gt=e=>c(c({},{debug:!0,deserialize:kt,key:"root",stateReconciler:Se,storage:O}),e);function ft(e,t=2e3){const s=ye({interval:t,limit:1})(a=>ve(e,a).catch(console.error));return{deleteItem:s,getItem:()=>he(e).then(a=>a.data()).then(console.tap).catch(console.error),setItem:s}}function mt(e){be(e);const t=Te();return Ie(t,"state","state")}const St=(e,t)=>{const s=mt(e);return ft(s,t)},ht=e=>Object.entries(JSON.parse(e)).reduce((t,[s,a])=>m(c({},t),{[s]:JSON.parse(a)}),{}),yt=(e=pt`firebaseConfig`,t=100)=>{const s=St(e,t),a={deleteItem:(...r)=>O.deleteItem(...r).then(i=>(s.deleteItem(),i)),getItem:s.getItem,setItem:(r,i)=>O.setItem(r,i).then(()=>s.setItem(ht(i)))};return gt({storage:a})};var vt={apiKey:"AIzaSyD7U2xm2iJuhM6XOs4dGMtAmqlT6TWh1I0",authDomain:"points-streaks.firebaseapp.com",projectId:"points-streaks",storageBucket:"points-streaks.appspot.com",messagingSenderId:"72274275033",appId:"1:72274275033:web:a9f21b39f1856ea326acc8"};const It=yt(vt),bt=c({key:"root",version:1},It);c(c(c(c({reset:y},w),ct),We),ce);const _={tasks:l,streaks:d,app:lt,bank:Ge},Tt=De({app:ot,streaks:Ye,bank:Ke,tasks:et}),Dt=Ae(bt,Tt),L=xe({reducer:Dt,middleware:e=>e({serializableCheck:{ignoredActions:[ze,$e,Ne,Ee,Pe,Ce]}}),devTools:!0});let At=Re(L);L.getState();const xt=e=>t=>{t.preventDefault(),e(console.tap(t.target.elements.tasks.value.split(`
`),"from the input"))},Rt=({createTask:e,createTasks:t})=>k("form",{onSubmit:xt(t),children:[n("textarea",{name:"tasks"}),n("button",{type:"submit",children:"Submit"})]}),zt=R(null,e=>({createTask:t=>e(w.createTask(t)),createTasks:t=>e(w.createTasks(t))}))(Rt),$t=e=>n(ue,c({},e)),ke=R((e,{status:t})=>({isDone:t===g.done}),e=>({toggleTaskStatus:t=>()=>e(w.toggleTaskStatus(t))}))($t);function Nt(){return new URL(document.location).searchParams.get("debug")==="ui"}function Et({streaks:e,tasks:t,lastRunDate:s,resolveDay:a,historicalTasks:r,activeTasks:i}){return we.exports.useEffect(()=>(Y.exports.startReportingRuntimeErrors({onError:()=>{}}),()=>Y.exports.stopReportingRuntimeErrors()),[]),k("div",{className:X("App",{debug:Nt()}),children:[n(zt,{}),k("button",{onClick:()=>a(),children:["Resolve ",s]}),k("div",{id:"task-section",children:[n("div",{className:"task-list",children:e.map(o=>n(nt,c({},o),o.id))}),k("span",{children:[n(Q,{to:"active",activeClassName:"active",className:"task-list-link",children:"Active"}),n(Q,{to:"history",activeClassName:"active",className:"task-list-link",children:"History"})]}),k(_e,{children:[n(Z,{path:"/active",element:k("div",{className:"task-list",children:[n("h3",{children:"Active"}),i.map(o=>n(ke,c({},o),o.id))]})}),n(Z,{path:"/history",element:k("div",{className:"task-list",children:[n("h3",{children:"History"}),r.map(o=>n(ke,c({},o),o.id))]})})]})]})]})}function Pt(e){var t={weekday:"long",month:"long",day:"numeric"};return new Intl.DateTimeFormat("en-US",t).format(new Date(e))}var Ct=R(e=>({state:e,lastRunDate:Pt(e.app.date),streaks:_.streaks.selectAll(e),tasks:_.tasks.selectAll(e),activeTasks:_.tasks.getActiveTasks(e),historicalTasks:_.tasks.getHistoricalTasks(e)}),e=>({resolveDay:t=>()=>e(v(it(t)))}),(i,M,r)=>{var o=i,{state:e}=o,t=A(o,["state"]);var S=M,{resolveDay:s}=S,a=A(S,["resolveDay"]);return m(c(c(c({},r),a),t),{resolveDay:s(e)})})(Et);const wt=({children:e})=>n(je,{store:L,children:n(Be,{loading:null,persistor:At,children:e})});console.tap=(e,...t)=>(console.log(e,...t),e);Fe.render(n(h.StrictMode,{children:n(Oe,{children:n(wt,{children:n(Ct,{})})})}),document.getElementById("root"));
