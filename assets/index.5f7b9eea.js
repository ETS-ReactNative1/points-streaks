var Se=Object.defineProperty,ve=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var K=(e,t,s)=>t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))W.call(t,s)&&K(e,s,t[s]);if(x)for(var s of x(t))G.call(t,s)&&K(e,s,t[s]);return e},f=(e,t)=>ve(e,Ie(t));var S=(e,t)=>{var s={};for(var a in e)W.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&x)for(var a of x(e))t.indexOf(a)<0&&G.call(e,a)&&(s[a]=e[a]);return s};import{c as O,a as z,b as X,n as Y,d as k,_ as be,e as j,h as Te,p as De,g as Re,D as Ae,i as $e,L as xe,j as o,f as Q,R as v,k as u,l as y,m as ze,o as Ee,q as _e,r as Ne,F as Pe,s as we,P as Ce,t as He,u as Oe,v as je,w as Be,x as Z,N as ee,y as Fe,z as te,A as Le,B as Ve,C as qe,E as Me}from"./vendor.4aa39175.js";const Ue=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}};Ue();const I=O("reset");O("set");const b=O("resolveDay"),E={pizza:"pizza"},se={points:0,special:{[E.pizza]:0}},ae={pizza:e=>{var t;return((t=e==null?void 0:e.points)!=null?t:e)*.05}},Je={extraReducers:{[I]:()=>se,[b]:(e,{payload:{bank:t}})=>{Object.entries(t).forEach(([s,a])=>{var r;s==="points"?e.points+=a:e.special[s]=((r=e.special[s])!=null?r:0)+a})}},initialState:se,name:"bank",reducers:{addPoints(e,{payload:t}){e.points+=t},addSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]+=t},setPoints(e,{payload:t}){e.points=t},setSpecial(e,{payload:{amount:t,type:s="pizza"}}){e.special[s]=t},spendPoints(e,{payload:t}){t<=e.points&&(e.points-=t)},spendSpecial(e,{payload:{amount:t,type:s="pizza"}}){t<=e.special[s]&&(e.special[s]-=t)}}},We=e=>{var t;return(t=e==null?void 0:e.bank)!=null?t:e},Ge=(e,t)=>{var s;return((s=e==null?void 0:e.bank)!=null?s:e).special[t]},Ke=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).special.pizza},Xe=e=>{var t;return((t=e==null?void 0:e.bank)!=null?t:e).points},Ye=(e,t)=>ae[t](e),re={getBank:We,getPizza:Ke,getPoints:Xe,getSpecial:Ge,getSpecialValue:Ye},ne=z(Je);var Qe=ne.reducer;const Ze=ne.actions,et=e=>{const t=e.reduce((s,a)=>(s[a.id.replace(/ /g,"-")]=a,s),{});return{entities:t,ids:Object.keys(t)}},ie=e=>t=>(s,{payload:a})=>e.updateOne(s,{changes:t,id:a}),oe=e=>t=>(s,a,...r)=>{var i,n;return e.updateOne(s,{changes:t(s.entities[(n=(i=a.payload)==null?void 0:i.id)!=null?n:a.payload],a,r),id:a.payload})},p={active:"active",done:"done"};function B(e,t={}){return c({currentStreakIndex:1,id:Y(),status:p.active,streakIterations:1,task:e},t)}const ce=6,T=X(),_="a",N="b";_+"",B(_,{id:_}),N+"",B(N,{id:N});const le=et(["email","meditate","teeth","clean 5%","quirk","walk","dev tea","luminosity","\u{1F50A}\u{1F4DA} (20)","read(20)","track \u{1F96A}","track \u{1F964}","fiber \u{1F9FB}","#points","reduce lists 5%"].map(e=>B(e,{id:e.replace(/ /g,"-")}))),F=ie(T),D=oe(T);function de(e){return e.currentStreakIndex===ce?{currentStreakIndex:1,streakIterations:e.streakIterations+1}:{currentStreakIndex:e.currentStreakIndex+1}}const ue=z({extraReducers:{[I]:(e,{payload:t})=>{var s;return T.getInitialState((s=t==null?void 0:t.streaks)!=null?s:le)},[b]:(e,{payload:t})=>{t.tasks&&Object.values(e.entities).forEach(s=>{s.status===p.active?(s.streakIterations=1,s.currentStreakIndex=1):(s.status=p.active,D(de)(e,{payload:s.id}))})}},initialState:T.getInitialState(le),name:"streaks",reducers:{bumpStreak:D(de),bumpStreakIndex:D(e=>({currentStreakIndex:e.currentStreakIndex+1})),bumpStreakIterations:D(e=>({streakIterations:e.streakIterations+1})),markTaskActive:F({status:p.active}),markTaskDone:F({status:p.done}),resetStreak:F({currentStreakIndex:1,status:p.active,streakIterations:1}),toggleTaskStatus:D(e=>({status:e.status===p.active?p.done:p.active}))}}),tt=ue.reducer,pe=ue.actions,d=T.getSelectors(e=>{var t;return(t=e==null?void 0:e.streaks)!=null?t:e});d.getStreak=d.selectById;d.getStreakIndex=k(d.getStreak,e=>e.currentStreakIndex);d.getStreakIteration=k(d.getStreak,e=>e.streakIterations);d.getStreakValue=k(d.getStreak,e=>e.status===p.active?0:e.currentStreakIndex===ce?E.pizza:e.currentStreakIndex*e.streakIterations);d.getDaysPoints=k([d.selectIds,e=>e],(e,t)=>e.map(s=>d.getStreakValue(t,s)).reduce((s,a)=>{var r;return Number.isInteger(a)?s.points+=a:s[E[a]]=((r=s==null?void 0:s[E[a]])!=null?r:0)+1,s},{points:0}));const st={active:"active",done:"done"};function P(e,t={}){return typeof e=="object"&&(t=e),c({history:[],id:Y(),status:st.active,task:e,value:1},t)}const w="a",C="b";w+"",P(w,{id:w}),C+"",P(C,{id:C});const g={active:"active",done:"done"},h=X(),ke=ie(h),ge=oe(h);function at(e,t){var a,r;const s=(r=(a=t==null?void 0:t.payload)==null?void 0:a.id)!=null?r:t.payload;return typeof s=="string"&&s in e.entities?s:null}const rt=ge((e,t)=>{e.history||(e.history=[]),e.history.push({action:t,date:Date.now()})}),nt=e=>(t,s)=>{const a=e(t,s);return at(a,s)?rt(a,s):a};function he(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>{const a=nt(s);return[t,a]}))}const L=z({extraReducers:he({[I]:()=>h.getInitialState({history:{}}),[b]:(e,t)=>{const{payload:s}=t;s.tasks&&Object.values(e.entities).forEach(a=>{a.status===g.done&&(e.history[a.id]=!0,a.value=0,a.history.push({action:t,date:Date.now()}))})}}),initialState:h.getInitialState({history:{}}),name:"tasks",reducers:he({createTask:(e,{payload:t})=>h.addOne(e,P(t)),createTasks:(e,{payload:t})=>h.addMany(e,t.map(s=>P(s))),markTaskActive:ke({status:g.active}),markTaskDone:ke({status:g.done}),restoreTask:(e,{payload:t})=>(e.history[t]=!1,h.updateOne(e,{changes:{status:g.active},id:t}),e),toggleTaskStatus:ge(e=>({status:e.status===g.active?g.done:g.active}))})});L.getInitialState();const it=L.reducer,R=L.actions,l=h.getSelectors(e=>{var t;return(t=e==null?void 0:e.tasks)!=null?t:e});l.getTask=l.selectById;l.getValue=k(l.getTask,e=>e.value);l.getDaysPoints=k([l.selectIds,e=>e],(e,t)=>e.reduce((s,a)=>s+l.getValue(t,a),0));l.getHistory=k(e=>e.tasks,e=>e.history);l.getHistoricalTasks=k(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>t[s.id]));l.getActiveTasks=k(l.selectAll,l.getHistory,(e,t)=>e.filter(s=>!t[s.id]));function ot(e){try{JSON.parse(e)}catch{return!1}return isNaN(e)}const ct=(e="param")=>()=>{throw new Error(`${Array.isArray(e)?e[0]:e} is required`)},lt=ct,dt=e=>ot(e)?JSON.parse(e):e,ut=e=>c(c({},{debug:!0,deserialize:dt,key:"root",stateReconciler:be,storage:j}),e);function pt(e,t=2e3){const s=De({interval:t,limit:1})(a=>Re(e,a).catch(console.error));return{deleteItem:s,getItem:()=>Te(e).then(a=>a.data()).catch(console.error),setItem:s}}function kt(e){$e(e);const t=xe();return Ae(t,"state","state")}const gt=(e,t)=>{const s=kt(e);return pt(s,t)},ht=e=>Object.entries(JSON.parse(e)).reduce((t,[s,a])=>f(c({},t),{[s]:JSON.parse(a)}),{}),mt=(e=lt`firebaseConfig`,t=100)=>{const s=gt(e,t),a={deleteItem:(...r)=>j.deleteItem(...r).then(i=>(s.deleteItem(),i)),getItem:s.getItem,setItem:(r,i)=>j.setItem(r,i).then(()=>s.setItem(ht(i)))};return ut({storage:a})},ft={apiKey:"AIzaSyD7U2xm2iJuhM6XOs4dGMtAmqlT6TWh1I0",appId:"1:72274275033:web:a9f21b39f1856ea326acc8",authDomain:"points-streaks.firebaseapp.com",messagingSenderId:"72274275033",projectId:"points-streaks",storageBucket:"points-streaks.appspot.com"},yt=(e,t)=>Math.abs(e-t),St=({streakIterations:e,currentStreakIndex:t})=>{const s=Array(5).fill(0).map((a,r)=>r+e).concat("\u{1F355}");return o("div",{className:"streak",children:s.map((a,r)=>o("span",{className:`point dist-${yt(t,r+1)}`,children:a},a))})},me=({task:e,children:t,isDone:s})=>o("h3",{className:Q("name",{done:s}),children:t!=null?t:e}),vt=({value:e,children:t})=>o("code",{className:"value",children:t!=null?t:e}),V=a=>{var r=a,{children:e,toggleTaskStatus:t}=r,s=S(r,["children","toggleTaskStatus"]);let i=v.Children.toArray(e);return i.length?i.length===1&&i.unshift(me):i=[me,vt],u("div",{className:"task",onClick:t,children:[o("input",{type:"checkbox",readOnly:!0,checked:s.isDone}),i.map((n,$)=>{var U,J;const m=`${s.id}_${(J=(U=n==null?void 0:n.type)==null?void 0:U.name)!=null?J:n.type}_${$}`;return v.isValidElement(n)?v.cloneElement(n,f(c({},s),{key:m})):v.createElement(n,f(c({},s),{key:m}))})]})},It=e=>o(V,f(c({},e),{children:o(St,{})})),bt=y((e,{status:t})=>({isDone:t===p.done}),(e,{id:t})=>({toggleTaskStatus:()=>e(pe.toggleTaskStatus(t))}))(It);function A(e=new Date){return new Date(e).setHours(0,0,0,0)}function Tt(e){return e.app.date===A()?{app:{},bank:{},streaks:!1,tasks:!1}:{app:{date:A()},bank:d.getDaysPoints(e),streaks:!0,tasks:!0}}const fe=z({extraReducers:{[I]:()=>({date:A()}),[b]:(e,{payload:t})=>{var s,a;e.date=(a=(s=t==null?void 0:t.app)==null?void 0:s.date)!=null?a:e.date}},initialState:{date:A()},name:"app",reducers:{setDate:(e,{payload:t})=>{e.date=A(t)}}});var Dt=fe.reducer;const Rt=fe.actions,At={},$t=mt(ft),xt=c({key:"root",version:1},$t);c(c(c(c({reset:I},R),Rt),Ze),pe);const H={app:At,bank:re,streaks:d,tasks:l},zt=ze({app:Dt,bank:Qe,streaks:tt,tasks:it}),Et=Ee(xt,zt),q=_e({devTools:!0,middleware:e=>e({serializableCheck:{ignoredActions:[Pe,we,Ce,He,Oe,je]}}),reducer:Et});let _t=Ne(q);q.getState();const Nt=e=>t=>{t.preventDefault(),e(t.target.elements.tasks.value.split(`
`))},Pt=({createTask:e,createTasks:t})=>u("form",{onSubmit:Nt(t),children:[o("textarea",{name:"tasks"}),o("button",{type:"submit",children:"Submit"})]}),wt=y(null,e=>({createTask:t=>e(R.createTask(t)),createTasks:t=>e(R.createTasks(t))}))(Pt),Ct=e=>o(V,c({},e)),Ht=y((e,{status:t})=>({isDone:t===g.done}),(e,{id:t})=>({toggleTaskStatus:()=>e(R.toggleTaskStatus(t))}))(Ct),Ot=s=>{var a=s,{restoreTask:e}=a,t=S(a,["restoreTask"]);return o(V,f(c({},t),{children:o("button",{onClick:e,children:"Restore"})}))},jt=y((e,{status:t})=>({isDone:t===g.done}),(e,{id:t})=>({toggleTaskStatus:()=>{},restoreTask:()=>e(R.restoreTask(t))}))(Ot),Bt=({special:e,points:t})=>u("main",{id:"bank",children:[o("h1",{children:"Bank"}),o("h3",{children:t}),Object.entries(e).map(([s,a])=>u("h3",{children:[s,":"," ",Math.round(ae[s](t)*a)]}))]}),Ft=y(re.getBank)(Bt);function Lt(){return new URL(document.location).searchParams.get("debug")==="ui"}function Vt({streaks:e,tasks:t,lastRunDate:s,resolveDay:a,historicalTasks:r,activeTasks:i}){return Be.exports.useEffect(()=>(Z.exports.startReportingRuntimeErrors({onError:()=>{}}),()=>Z.exports.stopReportingRuntimeErrors()),[]),u("div",{className:Q("App",{debug:Lt()}),children:[o(wt,{}),u("button",{onClick:()=>a(),children:["Resolve ",s]}),o(Ft,{}),u("div",{id:"task-section",children:[o("div",{className:"task-list",children:e.map(n=>o(bt,c({},n),n.id))}),u("span",{children:[o(ee,{to:"active",className:({isActive:n})=>`task-list-link ${n?"active":""}`,children:"Active"}),o(ee,{to:"history",className:({isActive:n})=>`task-list-link ${n?"active":""}`,children:"History"})]}),u(Fe,{children:[o(te,{path:"/active",element:u("div",{className:"task-list",children:[o("h3",{children:"Active"}),i.map(n=>o(Ht,c({},n),n.id))]})}),o(te,{path:"/history",element:u("div",{className:"task-list",children:[o("h3",{children:"History"}),r.map(n=>o(jt,c({},n),n.id))]})})]})]})]})}function qt(e){var t={day:"numeric",month:"long",weekday:"long"};return new Intl.DateTimeFormat("en-US",t).format(new Date(e))}var Mt=y(e=>({activeTasks:H.tasks.getActiveTasks(e),historicalTasks:H.tasks.getHistoricalTasks(e),lastRunDate:qt(e.app.date),state:e,streaks:H.streaks.selectAll(e),tasks:H.tasks.selectAll(e)}),e=>({resolveDay:t=>()=>e(b(Tt(t)))}),(i,$,r)=>{var n=i,{state:e}=n,t=S(n,["state"]);var m=$,{resolveDay:s}=m,a=S(m,["resolveDay"]);return f(c(c(c({},r),a),t),{resolveDay:s(e)})})(Vt);const Ut="modulepreload",ye={},Jt="/points-streaks/",Wt=function(t,s){return!s||s.length===0?t():Promise.all(s.map(a=>{if(a=`${Jt}${a}`,a in ye)return;ye[a]=!0;const r=a.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${i}`))return;const n=document.createElement("link");if(n.rel=r?"stylesheet":Ut,r||(n.as="script",n.crossOrigin=""),n.href=a,document.head.appendChild(n),r)return new Promise(($,m)=>{n.addEventListener("load",$),n.addEventListener("error",m)})})).then(()=>t())};let M=[];const Gt=e=>{M.push(e),M.length>=5&&console.table(M)},Kt=e=>{e&&e instanceof Function&&Wt(()=>import("./web-vitals.8eea515e.js"),[]).then(({getCLS:t,getFID:s,getFCP:a,getLCP:r,getTTFB:i})=>{t(e),s(e),a(e),r(e),i(e)})},Xt=({children:e})=>o(qe,{store:q,children:o(Me,{loading:null,persistor:_t,children:e})});console.tap=(e,...t)=>(console.log(e,...t),e);Le.render(o(v.StrictMode,{children:o(Ve,{children:o(Xt,{children:o(Mt,{})})})}),document.getElementById("root"));Kt(Gt);
